#include <gtest/gtest.h>
#include "../src/include/constants.hpp"
#include "../src/tensor.cpp"
#include "../src/layers/attention.cpp"


TEST(AttentionTest, TestPreComputeFreqCis) {
    std::vector<float> expected_data = {0.0000,     0.0000,     0.0000,     0.0000,     0.0000,     0.0000,
            0.0000,     0.0000,     0.0000,     0.0000,     0.0000,     0.0000,
            0.0000,     0.0000,     0.0000,     0.0000,     0.0000,     0.0000,
            0.0000,     0.0000,     0.0000,     0.0000,     0.0000,     0.0000,
            0.0000,     0.0000,     0.0000,     0.0000,     0.0000,     0.0000,
            0.0000,     0.0000,     1.0000,     0.7499,     0.5623,     0.4217,
            0.3162,     0.2371,     0.1778,     0.1334,     0.1000,     0.0750,
            0.0562,     0.0422,     0.0316,     0.0237,     0.0178,     0.0133,
            0.0100,     0.0075,     0.0056,     0.0042,     0.0032,     0.0024,
            0.0018,     0.0013,     0.0010,     0.0007,     0.0006,     0.0004,
            0.0003,     0.0002,     0.0002,     0.0001,     2.0000,     1.4998,
            1.1247,     0.8434,     0.6325,     0.4743,     0.3557,     0.2667,
            0.2000,     0.1500,     0.1125,     0.0843,     0.0632,     0.0474,
            0.0356,     0.0267,     0.0200,     0.0150,     0.0112,     0.0084,
            0.0063,     0.0047,     0.0036,     0.0027,     0.0020,     0.0015,
            0.0011,     0.0008,     0.0006,     0.0005,     0.0004,     0.0003,
            3.0000,     2.2497,     1.6870,     1.2651,     0.9487,     0.7114,
            0.5335,     0.4001,     0.3000,     0.2250,     0.1687,     0.1265,
            0.0949,     0.0711,     0.0533,     0.0400,     0.0300,     0.0225,
            0.0169,     0.0127,     0.0095,     0.0071,     0.0053,     0.0040,
            0.0030,     0.0022,     0.0017,     0.0013,     0.0009,     0.0007,
            0.0005,     0.0004,     4.0000,     2.9996,     2.2494,     1.6868,
            1.2649,     0.9485,     0.7113,     0.5334,     0.4000,     0.3000,
            0.2249,     0.1687,     0.1265,     0.0949,     0.0711,     0.0533,
            0.0400,     0.0300,     0.0225,     0.0169,     0.0126,     0.0095,
            0.0071,     0.0053,     0.0040,     0.0030,     0.0022,     0.0017,
            0.0013,     0.0009,     0.0007,     0.0005,     5.0000,     3.7495,
            2.8117,     2.1085,     1.5811,     1.1857,     0.8891,     0.6668,
            0.5000,     0.3749,     0.2812,     0.2108,     0.1581,     0.1186,
            0.0889,     0.0667,     0.0500,     0.0375,     0.0281,     0.0211,
            0.0158,     0.0119,     0.0089,     0.0067,     0.0050,     0.0037,
            0.0028,     0.0021,     0.0016,     0.0012,     0.0009,     0.0007,
            6.0000,     4.4994,     3.3740,     2.5302,     1.8974,     1.4228,
            1.0670,     0.8001,     0.6000,     0.4499,     0.3374,     0.2530,
            0.1897,     0.1423,     0.1067,     0.0800,     0.0600,     0.0450,
            0.0337,     0.0253,     0.0190,     0.0142,     0.0107,     0.0080,
            0.0060,     0.0045,     0.0034,     0.0025,     0.0019,     0.0014,
            0.0011,     0.0008,     7.0000,     5.2493,     3.9364,     2.9519,
            2.2136,     1.6600,     1.2448,     0.9335,     0.7000,     0.5249,
            0.3936,     0.2952,     0.2214,     0.1660,     0.1245,     0.0933,
            0.0700,     0.0525,     0.0394,     0.0295,     0.0221,     0.0166,
            0.0124,     0.0093,     0.0070,     0.0052,     0.0039,     0.0030,
            0.0022,     0.0017,     0.0012,     0.0009,     8.0000,     5.9992,
            4.4987,     3.3736,     2.5298,     1.8971,     1.4226,     1.0668,
            0.8000,     0.5999,     0.4499,     0.3374,     0.2530,     0.1897,
            0.1423,     0.1067,     0.0800,     0.0600,     0.0450,     0.0337,
            0.0253,     0.0190,     0.0142,     0.0107,     0.0080,     0.0060,
            0.0045,     0.0034,     0.0025,     0.0019,     0.0014,     0.0011,
            9.0000,     6.7490,     5.0611,     3.7953,     2.8460,     2.1342,
            1.6005,     1.2002,     0.9000,     0.6749,     0.5061,     0.3795,
            0.2846,     0.2134,     0.1600,     0.1200,     0.0900,     0.0675,
            0.0506,     0.0380,     0.0285,     0.0213,     0.0160,     0.0120,
            0.0090,     0.0067,     0.0051,     0.0038,     0.0028,     0.0021,
            0.0016,     0.0012,    10.0000,     7.4989,     5.6234,     4.2170,
            3.1623,     2.3714,     1.7783,     1.3335,     1.0000,     0.7499,
            0.5623,     0.4217,     0.3162,     0.2371,     0.1778,     0.1334,
            0.1000,     0.0750,     0.0562,     0.0422,     0.0316,     0.0237,
            0.0178,     0.0133,     0.0100,     0.0075,     0.0056,     0.0042,
            0.0032,     0.0024,     0.0018,     0.0013,    11.0000,     8.2488,
            6.1858,     4.6387,     3.4785,     2.6085,     1.9561,     1.4669,
            1.1000,     0.8249,     0.6186,     0.4639,     0.3479,     0.2609,
            0.1956,     0.1467,     0.1100,     0.0825,     0.0619,     0.0464,
            0.0348,     0.0261,     0.0196,     0.0147,     0.0110,     0.0082,
            0.0062,     0.0046,     0.0035,     0.0026,     0.0020,     0.0015,
           12.0000,     8.9987,     6.7481,     5.0604,     3.7947,     2.8456,
            2.1339,     1.6002,     1.2000,     0.8999,     0.6748,     0.5060,
            0.3795,     0.2846,     0.2134,     0.1600,     0.1200,     0.0900,
            0.0675,     0.0506,     0.0379,     0.0285,     0.0213,     0.0160,
            0.0120,     0.0090,     0.0067,     0.0051,     0.0038,     0.0028,
            0.0021,     0.0016,    13.0000,     9.7486,     7.3104,     5.4821,
            4.1110,     3.0828,     2.3118,     1.7336,     1.3000,     0.9749,
            0.7310,     0.5482,     0.4111,     0.3083,     0.2312,     0.1734,
            0.1300,     0.0975,     0.0731,     0.0548,     0.0411,     0.0308,
            0.0231,     0.0173,     0.0130,     0.0097,     0.0073,     0.0055,
            0.0041,     0.0031,     0.0023,     0.0017,    14.0000,    10.4985,
            7.8728,     5.9038,     4.4272,     3.3199,     2.4896,     1.8669,
            1.4000,     1.0499,     0.7873,     0.5904,     0.4427,     0.3320,
            0.2490,     0.1867,     0.1400,     0.1050,     0.0787,     0.0590,
            0.0443,     0.0332,     0.0249,     0.0187,     0.0140,     0.0105,
            0.0079,     0.0059,     0.0044,     0.0033,     0.0025,     0.0019,
           15.0000,    11.2484,     8.4351,     6.3254,     4.7434,     3.5571,
            2.6674,     2.0003,     1.5000,     1.1248,     0.8435,     0.6325,
            0.4743,     0.3557,     0.2667,     0.2000,     0.1500,     0.1125,
            0.0844,     0.0633,     0.0474,     0.0356,     0.0267,     0.0200,
            0.0150,     0.0112,     0.0084,     0.0063,     0.0047,     0.0036,
            0.0027,     0.0020,    16.0000,    11.9983,     8.9975,     6.7471,
            5.0596,     3.7942,     2.8452,     2.1336,     1.6000,     1.1998,
            0.8997,     0.6747,     0.5060,     0.3794,     0.2845,     0.2134,
            0.1600,     0.1200,     0.0900,     0.0675,     0.0506,     0.0379,
            0.0285,     0.0213,     0.0160,     0.0120,     0.0090,     0.0067,
            0.0051,     0.0038,     0.0028,     0.0021,    17.0000,    12.7482,
            9.5598,     7.1688,     5.3759,     4.0313,     3.0231,     2.2670,
            1.7000,     1.2748,     0.9560,     0.7169,     0.5376,     0.4031,
            0.3023,     0.2267,     0.1700,     0.1275,     0.0956,     0.0717,
            0.0538,     0.0403,     0.0302,     0.0227,     0.0170,     0.0127,
            0.0096,     0.0072,     0.0054,     0.0040,     0.0030,     0.0023,
           18.0000,    13.4981,    10.1221,     7.5905,     5.6921,     4.2685,
            3.2009,     2.4003,     1.8000,     1.3498,     1.0122,     0.7591,
            0.5692,     0.4268,     0.3201,     0.2400,     0.1800,     0.1350,
            0.1012,     0.0759,     0.0569,     0.0427,     0.0320,     0.0240,
            0.0180,     0.0135,     0.0101,     0.0076,     0.0057,     0.0043,
            0.0032,     0.0024,    19.0000,    14.2480,    10.6845,     8.0122,
            6.0083,     4.5056,     3.3787,     2.5337,     1.9000,     1.4248,
            1.0684,     0.8012,     0.6008,     0.4506,     0.3379,     0.2534,
            0.1900,     0.1425,     0.1068,     0.0801,     0.0601,     0.0451,
            0.0338,     0.0253,     0.0190,     0.0142,     0.0107,     0.0080,
            0.0060,     0.0045,     0.0034,     0.0025,    20.0000,    14.9979,
           11.2468,     8.4339,     6.3246,     4.7427,     3.5566,     2.6670,
            2.0000,     1.4998,     1.1247,     0.8434,     0.6325,     0.4743,
            0.3557,     0.2667,     0.2000,     0.1500,     0.1125,     0.0843,
            0.0632,     0.0474,     0.0356,     0.0267,     0.0200,     0.0150,
            0.0112,     0.0084,     0.0063,     0.0047,     0.0036,     0.0027,
           21.0000,    15.7478,    11.8092,     8.8556,     6.6408,     4.9799,
            3.7344,     2.8004,     2.1000,     1.5748,     1.1809,     0.8856,
            0.6641,     0.4980,     0.3734,     0.2800,     0.2100,     0.1575,
            0.1181,     0.0886,     0.0664,     0.0498,     0.0373,     0.0280,
            0.0210,     0.0157,     0.0118,     0.0089,     0.0066,     0.0050,
            0.0037,     0.0028,    22.0000,    16.4977,    12.3715,     9.2773,
            6.9570,     5.2170,     3.9122,     2.9337,     2.2000,     1.6498,
            1.2372,     0.9277,     0.6957,     0.5217,     0.3912,     0.2934,
            0.2200,     0.1650,     0.1237,     0.0928,     0.0696,     0.0522,
            0.0391,     0.0293,     0.0220,     0.0165,     0.0124,     0.0093,
            0.0070,     0.0052,     0.0039,     0.0029,    23.0000,    17.2476,
           12.9339,     9.6990,     7.2732,     5.4542,     4.0900,     3.0671,
            2.3000,     1.7248,     1.2934,     0.9699,     0.7273,     0.5454,
            0.4090,     0.3067,     0.2300,     0.1725,     0.1293,     0.0970,
            0.0727,     0.0545,     0.0409,     0.0307,     0.0230,     0.0172,
            0.0129,     0.0097,     0.0073,     0.0055,     0.0041,     0.0031,
           24.0000,    17.9975,    13.4962,    10.1207,     7.5895,     5.6913,
            4.2679,     3.2005,     2.4000,     1.7997,     1.3496,     1.0121,
            0.7589,     0.5691,     0.4268,     0.3200,     0.2400,     0.1800,
            0.1350,     0.1012,     0.0759,     0.0569,     0.0427,     0.0320,
            0.0240,     0.0180,     0.0135,     0.0101,     0.0076,     0.0057,
            0.0043,     0.0032,    25.0000,    18.7474,    14.0585,    10.5424,
            7.9057,     5.9284,     4.4457,     3.3338,     2.5000,     1.8747,
            1.4059,     1.0542,     0.7906,     0.5928,     0.4446,     0.3334,
            0.2500,     0.1875,     0.1406,     0.1054,     0.0791,     0.0593,
            0.0445,     0.0333,     0.0250,     0.0187,     0.0141,     0.0105,
            0.0079,     0.0059,     0.0044,     0.0033,    26.0000,    19.4972,
           14.6209,    10.9641,     8.2219,     6.1656,     4.6235,     3.4672,
            2.6000,     1.9497,     1.4621,     1.0964,     0.8222,     0.6166,
            0.4624,     0.3467,     0.2600,     0.1950,     0.1462,     0.1096,
            0.0822,     0.0617,     0.0462,     0.0347,     0.0260,     0.0195,
            0.0146,     0.0110,     0.0082,     0.0062,     0.0046,     0.0035,
           27.0000,    20.2471,    15.1832,    11.3858,     8.5381,     6.4027,
            4.8014,     3.6005,     2.7000,     2.0247,     1.5183,     1.1386,
            0.8538,     0.6403,     0.4801,     0.3601,     0.2700,     0.2025,
            0.1518,     0.1139,     0.0854,     0.0640,     0.0480,     0.0360,
            0.0270,     0.0202,     0.0152,     0.0114,     0.0085,     0.0064,
            0.0048,     0.0036,    28.0000,    20.9970,    15.7456,    11.8075,
            8.8544,     6.6398,     4.9792,     3.7339,     2.8000,     2.0997,
            1.5746,     1.1808,     0.8854,     0.6640,     0.4979,     0.3734,
            0.2800,     0.2100,     0.1575,     0.1181,     0.0885,     0.0664,
            0.0498,     0.0373,     0.0280,     0.0210,     0.0157,     0.0118,
            0.0089,     0.0066,     0.0050,     0.0037,    29.0000,    21.7469,
           16.3079,    12.2292,     9.1706,     6.8770,     5.1570,     3.8672,
            2.9000,     2.1747,     1.6308,     1.2229,     0.9171,     0.6877,
            0.5157,     0.3867,     0.2900,     0.2175,     0.1631,     0.1223,
            0.0917,     0.0688,     0.0516,     0.0387,     0.0290,     0.0217,
            0.0163,     0.0122,     0.0092,     0.0069,     0.0052,     0.0039,
           30.0000,    22.4968,    16.8702,    12.6509,     9.4868,     7.1141,
            5.3348,     4.0006,     3.0000,     2.2497,     1.6870,     1.2651,
            0.9487,     0.7114,     0.5335,     0.4001,     0.3000,     0.2250,
            0.1687,     0.1265,     0.0949,     0.0711,     0.0533,     0.0400,
            0.0300,     0.0225,     0.0169,     0.0127,     0.0095,     0.0071,
            0.0053,     0.0040,    31.0000,    23.2467,    17.4326,    13.0726,
            9.8031,     7.3513,     5.5127,     4.1339,     3.1000,     2.3247,
            1.7433,     1.3073,     0.9803,     0.7351,     0.5513,     0.4134,
            0.3100,     0.2325,     0.1743,     0.1307,     0.0980,     0.0735,
            0.0551,     0.0413,     0.0310,     0.0232,     0.0174,     0.0131,
            0.0098,     0.0074,     0.0055,     0.0041,    32.0000,    23.9966,
           17.9949,    13.4943,    10.1193,     7.5884,     5.6905,     4.2673,
            3.2000,     2.3997,     1.7995,     1.3494,     1.0119,     0.7588,
            0.5690,     0.4267,     0.3200,     0.2400,     0.1799,     0.1349,
            0.1012,     0.0759,     0.0569,     0.0427,     0.0320,     0.0240,
            0.0180,     0.0135,     0.0101,     0.0076,     0.0057,     0.0043,
           33.0000,    24.7465,    18.5573,    13.9160,    10.4355,     7.8255,
            5.8683,     4.4006,     3.3000,     2.4747,     1.8557,     1.3916,
            1.0436,     0.7826,     0.5868,     0.4401,     0.3300,     0.2475,
            0.1856,     0.1392,     0.1044,     0.0783,     0.0587,     0.0440,
            0.0330,     0.0247,     0.0186,     0.0139,     0.0104,     0.0078,
            0.0059,     0.0044,    34.0000,    25.4964,    19.1196,    14.3377,
           10.7517,     8.0627,     6.0461,     4.5340,     3.4000,     2.5496,
            1.9120,     1.4338,     1.0752,     0.8063,     0.6046,     0.4534,
            0.3400,     0.2550,     0.1912,     0.1434,     0.1075,     0.0806,
            0.0605,     0.0453,     0.0340,     0.0255,     0.0191,     0.0143,
            0.0108,     0.0081,     0.0060,     0.0045,    35.0000,    26.2463,
           19.6819,    14.7594,    11.0680,     8.2998,     6.2240,     4.6673,
            3.5000,     2.6246,     1.9682,     1.4759,     1.1068,     0.8300,
            0.6224,     0.4667,     0.3500,     0.2625,     0.1968,     0.1476,
            0.1107,     0.0830,     0.0622,     0.0467,     0.0350,     0.0262,
            0.0197,     0.0148,     0.0111,     0.0083,     0.0062,     0.0047,
           36.0000,    26.9962,    20.2443,    15.1811,    11.3842,     8.5369,
            6.4018,     4.8007,     3.6000,     2.6996,     2.0244,     1.5181,
            1.1384,     0.8537,     0.6402,     0.4801,     0.3600,     0.2700,
            0.2024,     0.1518,     0.1138,     0.0854,     0.0640,     0.0480,
            0.0360,     0.0270,     0.0202,     0.0152,     0.0114,     0.0085,
            0.0064,     0.0048,    37.0000,    27.7461,    20.8066,    15.6028,
           11.7004,     8.7741,     6.5796,     4.9340,     3.7000,     2.7746,
            2.0807,     1.5603,     1.1700,     0.8774,     0.6580,     0.4934,
            0.3700,     0.2775,     0.2081,     0.1560,     0.1170,     0.0877,
            0.0658,     0.0493,     0.0370,     0.0277,     0.0208,     0.0156,
            0.0117,     0.0088,     0.0066,     0.0049,    38.0000,    28.4960,
           21.3690,    16.0245,    12.0167,     9.0112,     6.7575,     5.0674,
            3.8000,     2.8496,     2.1369,     1.6024,     1.2017,     0.9011,
            0.6757,     0.5067,     0.3800,     0.2850,     0.2137,     0.1602,
            0.1202,     0.0901,     0.0676,     0.0507,     0.0380,     0.0285,
            0.0214,     0.0160,     0.0120,     0.0090,     0.0068,     0.0051,
           39.0000,    29.2459,    21.9313,    16.4462,    12.3329,     9.2484,
            6.9353,     5.2007,     3.9000,     2.9246,     2.1931,     1.6446,
            1.2333,     0.9248,     0.6935,     0.5201,     0.3900,     0.2925,
            0.2193,     0.1645,     0.1233,     0.0925,     0.0694,     0.0520,
            0.0390,     0.0292,     0.0219,     0.0164,     0.0123,     0.0092,
            0.0069,     0.0052,    40.0000,    29.9958,    22.4937,    16.8679,
           12.6491,     9.4855,     7.1131,     5.3341,     4.0000,     2.9996,
            2.2494,     1.6868,     1.2649,     0.9485,     0.7113,     0.5334,
            0.4000,     0.3000,     0.2249,     0.1687,     0.1265,     0.0949,
            0.0711,     0.0533,     0.0400,     0.0300,     0.0225,     0.0169,
            0.0126,     0.0095,     0.0071,     0.0053,    41.0000,    30.7457,
           23.0560,    17.2896,    12.9653,     9.7226,     7.2909,     5.4674,
            4.1000,     3.0746,     2.3056,     1.7290,     1.2965,     0.9723,
            0.7291,     0.5467,     0.4100,     0.3075,     0.2306,     0.1729,
            0.1297,     0.0972,     0.0729,     0.0547,     0.0410,     0.0307,
            0.0231,     0.0173,     0.0130,     0.0097,     0.0073,     0.0055,
           42.0000,    31.4956,    23.6183,    17.7113,    13.2816,     9.9598,
            7.4688,     5.6008,     4.2000,     3.1496,     2.3618,     1.7711,
            1.3282,     0.9960,     0.7469,     0.5601,     0.4200,     0.3150,
            0.2362,     0.1771,     0.1328,     0.0996,     0.0747,     0.0560,
            0.0420,     0.0315,     0.0236,     0.0177,     0.0133,     0.0100,
            0.0075,     0.0056,    43.0000,    32.2454,    24.1807,    18.1329,
           13.5978,    10.1969,     7.6466,     5.7341,     4.3000,     3.2245,
            2.4181,     1.8133,     1.3598,     1.0197,     0.7647,     0.5734,
            0.4300,     0.3225,     0.2418,     0.1813,     0.1360,     0.1020,
            0.0765,     0.0573,     0.0430,     0.0322,     0.0242,     0.0181,
            0.0136,     0.0102,     0.0076,     0.0057,    44.0000,    32.9953,
           24.7430,    18.5546,    13.9140,    10.4340,     7.8244,     5.8675,
            4.4000,     3.2995,     2.4743,     1.8555,     1.3914,     1.0434,
            0.7824,     0.5867,     0.4400,     0.3300,     0.2474,     0.1855,
            0.1391,     0.1043,     0.0782,     0.0587,     0.0440,     0.0330,
            0.0247,     0.0186,     0.0139,     0.0104,     0.0078,     0.0059,
           45.0000,    33.7452,    25.3054,    18.9763,    14.2302,    10.6712,
            8.0023,     6.0008,     4.5000,     3.3745,     2.5305,     1.8976,
            1.4230,     1.0671,     0.8002,     0.6001,     0.4500,     0.3375,
            0.2531,     0.1898,     0.1423,     0.1067,     0.0800,     0.0600,
            0.0450,     0.0337,     0.0253,     0.0190,     0.0142,     0.0107,
            0.0080,     0.0060,    46.0000,    34.4951,    25.8677,    19.3980,
           14.5465,    10.9083,     8.1801,     6.1342,     4.6000,     3.4495,
            2.5868,     1.9398,     1.4546,     1.0908,     0.8180,     0.6134,
            0.4600,     0.3450,     0.2587,     0.1940,     0.1455,     0.1091,
            0.0818,     0.0613,     0.0460,     0.0345,     0.0259,     0.0194,
            0.0145,     0.0109,     0.0082,     0.0061,    47.0000,    35.2450,
           26.4300,    19.8197,    14.8627,    11.1455,     8.3579,     6.2676,
            4.7000,     3.5245,     2.6430,     1.9820,     1.4863,     1.1145,
            0.8358,     0.6268,     0.4700,     0.3525,     0.2643,     0.1982,
            0.1486,     0.1115,     0.0836,     0.0627,     0.0470,     0.0352,
            0.0264,     0.0198,     0.0149,     0.0111,     0.0084,     0.0063,
           48.0000,    35.9949,    26.9924,    20.2414,    15.1789,    11.3826,
            8.5357,     6.4009,     4.8000,     3.5995,     2.6992,     2.0241,
            1.5179,     1.1383,     0.8536,     0.6401,     0.4800,     0.3599,
            0.2699,     0.2024,     0.1518,     0.1138,     0.0854,     0.0640,
            0.0480,     0.0360,     0.0270,     0.0202,     0.0152,     0.0114,
            0.0085,     0.0064,    49.0000,    36.7448,    27.5547,    20.6631,
           15.4952,    11.6197,     8.7136,     6.5343,     4.9000,     3.6745,
            2.7555,     2.0663,     1.5495,     1.1620,     0.8714,     0.6534,
            0.4900,     0.3674,     0.2755,     0.2066,     0.1550,     0.1162,
            0.0871,     0.0653,     0.0490,     0.0367,     0.0276,     0.0207,
            0.0155,     0.0116,     0.0087,     0.0065,    50.0000,    37.4947,
           28.1171,    21.0848,    15.8114,    11.8569,     8.8914,     6.6676,
            5.0000,     3.7495,     2.8117,     2.1085,     1.5811,     1.1857,
            0.8891,     0.6668,     0.5000,     0.3749,     0.2812,     0.2108,
            0.1581,     0.1186,     0.0889,     0.0667,     0.0500,     0.0375,
            0.0281,     0.0211,     0.0158,     0.0119,     0.0089,     0.0067,
           51.0000,    38.2446,    28.6794,    21.5065,    16.1276,    12.0940,
            9.0692,     6.8010,     5.1000,     3.8245,     2.8679,     2.1507,
            1.6128,     1.2094,     0.9069,     0.6801,     0.5100,     0.3824,
            0.2868,     0.2151,     0.1613,     0.1209,     0.0907,     0.0680,
            0.0510,     0.0382,     0.0287,     0.0215,     0.0161,     0.0121,
            0.0091,     0.0068,    52.0000,    38.9945,    29.2417,    21.9282,
           16.4438,    12.3311,     9.2471,     6.9343,     5.2000,     3.8994,
            2.9242,     2.1928,     1.6444,     1.2331,     0.9247,     0.6934,
            0.5200,     0.3899,     0.2924,     0.2193,     0.1644,     0.1233,
            0.0925,     0.0693,     0.0520,     0.0390,     0.0292,     0.0219,
            0.0164,     0.0123,     0.0092,     0.0069,    53.0000,    39.7444,
           29.8041,    22.3499,    16.7601,    12.5683,     9.4249,     7.0677,
            5.3000,     3.9744,     2.9804,     2.2350,     1.6760,     1.2568,
            0.9425,     0.7068,     0.5300,     0.3974,     0.2980,     0.2235,
            0.1676,     0.1257,     0.0942,     0.0707,     0.0530,     0.0397,
            0.0298,     0.0223,     0.0168,     0.0126,     0.0094,     0.0071,
           54.0000,    40.4943,    30.3664,    22.7716,    17.0763,    12.8054,
            9.6027,     7.2010,     5.4000,     4.0494,     3.0366,     2.2772,
            1.7076,     1.2805,     0.9603,     0.7201,     0.5400,     0.4049,
            0.3037,     0.2277,     0.1708,     0.1281,     0.0960,     0.0720,
            0.0540,     0.0405,     0.0304,     0.0228,     0.0171,     0.0128,
            0.0096,     0.0072,    55.0000,    41.2442,    30.9288,    23.1933,
           17.3925,    13.0426,     9.7805,     7.3344,     5.5000,     4.1244,
            3.0929,     2.3193,     1.7393,     1.3043,     0.9781,     0.7334,
            0.5500,     0.4124,     0.3093,     0.2319,     0.1739,     0.1304,
            0.0978,     0.0733,     0.0550,     0.0412,     0.0309,     0.0232,
            0.0174,     0.0130,     0.0098,     0.0073,    56.0000,    41.9941,
           31.4911,    23.6150,    17.7088,    13.2797,     9.9584,     7.4677,
            5.6000,     4.1994,     3.1491,     2.3615,     1.7709,     1.3280,
            0.9958,     0.7468,     0.5600,     0.4199,     0.3149,     0.2362,
            0.1771,     0.1328,     0.0996,     0.0747,     0.0560,     0.0420,
            0.0315,     0.0236,     0.0177,     0.0133,     0.0100,     0.0075,
           57.0000,    42.7440,    32.0535,    24.0367,    18.0250,    13.5168,
           10.1362,     7.6011,     5.7000,     4.2744,     3.2053,     2.4037,
            1.8025,     1.3517,     1.0136,     0.7601,     0.5700,     0.4274,
            0.3205,     0.2404,     0.1802,     0.1352,     0.1014,     0.0760,
            0.0570,     0.0427,     0.0321,     0.0240,     0.0180,     0.0135,
            0.0101,     0.0076,    58.0000,    43.4939,    32.6158,    24.4584,
           18.3412,    13.7540,    10.3140,     7.7344,     5.8000,     4.3494,
            3.2616,     2.4458,     1.8341,     1.3754,     1.0314,     0.7734,
            0.5800,     0.4349,     0.3262,     0.2446,     0.1834,     0.1375,
            0.1031,     0.0773,     0.0580,     0.0435,     0.0326,     0.0245,
            0.0183,     0.0138,     0.0103,     0.0077,    59.0000,    44.2438,
           33.1781,    24.8801,    18.6574,    13.9911,    10.4918,     7.8678,
            5.9000,     4.4244,     3.3178,     2.4880,     1.8657,     1.3991,
            1.0492,     0.7868,     0.5900,     0.4424,     0.3318,     0.2488,
            0.1866,     0.1399,     0.1049,     0.0787,     0.0590,     0.0442,
            0.0332,     0.0249,     0.0187,     0.0140,     0.0105,     0.0079,
           60.0000,    44.9937,    33.7405,    25.3018,    18.9737,    14.2282,
           10.6697,     8.0011,     6.0000,     4.4994,     3.3740,     2.5302,
            1.8974,     1.4228,     1.0670,     0.8001,     0.6000,     0.4499,
            0.3374,     0.2530,     0.1897,     0.1423,     0.1067,     0.0800,
            0.0600,     0.0450,     0.0337,     0.0253,     0.0190,     0.0142,
            0.0107,     0.0080,    61.0000,    45.7435,    34.3028,    25.7235,
           19.2899,    14.4654,    10.8475,     8.1345,     6.1000,     4.5744,
            3.4303,     2.5723,     1.9290,     1.4465,     1.0848,     0.8134,
            0.6100,     0.4574,     0.3430,     0.2572,     0.1929,     0.1447,
            0.1085,     0.0813,     0.0610,     0.0457,     0.0343,     0.0257,
            0.0193,     0.0145,     0.0108,     0.0081,    62.0000,    46.4934,
           34.8652,    26.1452,    19.6061,    14.7025,    11.0253,     8.2678,
            6.2000,     4.6493,     3.4865,     2.6145,     1.9606,     1.4703,
            1.1025,     0.8268,     0.6200,     0.4649,     0.3487,     0.2615,
            0.1961,     0.1470,     0.1103,     0.0827,     0.0620,     0.0465,
            0.0349,     0.0261,     0.0196,     0.0147,     0.0110,     0.0083,
           63.0000,    47.2433,    35.4275,    26.5669,    19.9223,    14.9397,
           11.2032,     8.4012,     6.3000,     4.7243,     3.5428,     2.6567,
            1.9922,     1.4940,     1.1203,     0.8401,     0.6300,     0.4724,
            0.3543,     0.2657,     0.1992,     0.1494,     0.1120,     0.0840,
            0.0630,     0.0472,     0.0354,     0.0266,     0.0199,     0.0149,
            0.0112,     0.0084,    64.0000,    47.9932,    35.9898,    26.9886,
           20.2386,    15.1768,    11.3810,     8.5345,     6.4000,     4.7993,
            3.5990,     2.6989,     2.0239,     1.5177,     1.1381,     0.8535,
            0.6400,     0.4799,     0.3599,     0.2699,     0.2024,     0.1518,
            0.1138,     0.0853,     0.0640,     0.0480,     0.0360,     0.0270,
            0.0202,     0.0152,     0.0114,     0.0085,    65.0000,    48.7431,
           36.5522,    27.4103,    20.5548,    15.4139,    11.5588,     8.6679,
            6.5000,     4.8743,     3.6552,     2.7410,     2.0555,     1.5414,
            1.1559,     0.8668,     0.6500,     0.4874,     0.3655,     0.2741,
            0.2055,     0.1541,     0.1156,     0.0867,     0.0650,     0.0487,
            0.0366,     0.0274,     0.0206,     0.0154,     0.0116,     0.0087,
           66.0000,    49.4930,    37.1145,    27.8320,    20.8710,    15.6511,
           11.7366,     8.8012,     6.6000,     4.9493,     3.7115,     2.7832,
            2.0871,     1.5651,     1.1737,     0.8801,     0.6600,     0.4949,
            0.3711,     0.2783,     0.2087,     0.1565,     0.1174,     0.0880,
            0.0660,     0.0495,     0.0371,     0.0278,     0.0209,     0.0157,
            0.0117,     0.0088,    67.0000,    50.2429,    37.6769,    28.2537,
           21.1873,    15.8882,    11.9145,     8.9346,     6.7000,     5.0243,
            3.7677,     2.8254,     2.1187,     1.5888,     1.1914,     0.8935,
            0.6700,     0.5024,     0.3768,     0.2825,     0.2119,     0.1589,
            0.1191,     0.0893,     0.0670,     0.0502,     0.0377,     0.0283,
            0.0212,     0.0159,     0.0119,     0.0089,    68.0000,    50.9928,
           38.2392,    28.6754,    21.5035,    16.1253,    12.0923,     9.0679,
            6.8000,     5.0993,     3.8239,     2.8675,     2.1503,     1.6125,
            1.2092,     0.9068,     0.6800,     0.5099,     0.3824,     0.2868,
            0.2150,     0.1613,     0.1209,     0.0907,     0.0680,     0.0510,
            0.0382,     0.0287,     0.0215,     0.0161,     0.0121,     0.0091,
           69.0000,    51.7427,    38.8016,    29.0971,    21.8197,    16.3625,
           12.2701,     9.2013,     6.9000,     5.1743,     3.8802,     2.9097,
            2.1820,     1.6362,     1.2270,     0.9201,     0.6900,     0.5174,
            0.3880,     0.2910,     0.2182,     0.1636,     0.1227,     0.0920,
            0.0690,     0.0517,     0.0388,     0.0291,     0.0218,     0.0164,
            0.0123,     0.0092,    70.0000,    52.4926,    39.3639,    29.5188,
           22.1359,    16.5996,    12.4480,     9.3347,     7.0000,     5.2493,
            3.9364,     2.9519,     2.2136,     1.6600,     1.2448,     0.9335,
            0.7000,     0.5249,     0.3936,     0.2952,     0.2214,     0.1660,
            0.1245,     0.0933,     0.0700,     0.0525,     0.0394,     0.0295,
            0.0221,     0.0166,     0.0124,     0.0093,    71.0000,    53.2425,
           39.9262,    29.9405,    22.4522,    16.8368,    12.6258,     9.4680,
            7.1000,     5.3242,     3.9926,     2.9940,     2.2452,     1.6837,
            1.2626,     0.9468,     0.7100,     0.5324,     0.3993,     0.2994,
            0.2245,     0.1684,     0.1263,     0.0947,     0.0710,     0.0532,
            0.0399,     0.0299,     0.0225,     0.0168,     0.0126,     0.0095,
           72.0000,    53.9924,    40.4886,    30.3621,    22.7684,    17.0739,
           12.8036,     9.6014,     7.2000,     5.3992,     4.0489,     3.0362,
            2.2768,     1.7074,     1.2804,     0.9601,     0.7200,     0.5399,
            0.4049,     0.3036,     0.2277,     0.1707,     0.1280,     0.0960,
            0.0720,     0.0540,     0.0405,     0.0304,     0.0228,     0.0171,
            0.0128,     0.0096,    73.0000,    54.7423,    41.0509,    30.7838,
           23.0846,    17.3110,    12.9814,     9.7347,     7.3000,     5.4742,
            4.1051,     3.0784,     2.3085,     1.7311,     1.2981,     0.9735,
            0.7300,     0.5474,     0.4105,     0.3078,     0.2308,     0.1731,
            0.1298,     0.0973,     0.0730,     0.0547,     0.0411,     0.0308,
            0.0231,     0.0173,     0.0130,     0.0097,    74.0000,    55.4922,
           41.6133,    31.2055,    23.4009,    17.5482,    13.1593,     9.8681,
            7.4000,     5.5492,     4.1613,     3.1206,     2.3401,     1.7548,
            1.3159,     0.9868,     0.7400,     0.5549,     0.4161,     0.3121,
            0.2340,     0.1755,     0.1316,     0.0987,     0.0740,     0.0555,
            0.0416,     0.0312,     0.0234,     0.0175,     0.0132,     0.0099,
           75.0000,    56.2421,    42.1756,    31.6272,    23.7171,    17.7853,
           13.3371,    10.0014,     7.5000,     5.6242,     4.2176,     3.1627,
            2.3717,     1.7785,     1.3337,     1.0001,     0.7500,     0.5624,
            0.4218,     0.3163,     0.2372,     0.1779,     0.1334,     0.1000,
            0.0750,     0.0562,     0.0422,     0.0316,     0.0237,     0.0178,
            0.0133,     0.0100,    76.0000,    56.9920,    42.7379,    32.0489,
           24.0333,    18.0224,    13.5149,    10.1348,     7.6000,     5.6992,
            4.2738,     3.2049,     2.4033,     1.8022,     1.3515,     1.0135,
            0.7600,     0.5699,     0.4274,     0.3205,     0.2403,     0.1802,
            0.1351,     0.1013,     0.0760,     0.0570,     0.0427,     0.0320,
            0.0240,     0.0180,     0.0135,     0.0101,    77.0000,    57.7419,
           43.3003,    32.4706,    24.3495,    18.2596,    13.6928,    10.2681,
            7.7000,     5.7742,     4.3300,     3.2471,     2.4350,     1.8260,
            1.3693,     1.0268,     0.7700,     0.5774,     0.4330,     0.3247,
            0.2435,     0.1826,     0.1369,     0.1027,     0.0770,     0.0577,
            0.0433,     0.0325,     0.0243,     0.0183,     0.0137,     0.0103,
           78.0000,    58.4917,    43.8626,    32.8923,    24.6658,    18.4967,
           13.8706,    10.4015,     7.8000,     5.8492,     4.3863,     3.2892,
            2.4666,     1.8497,     1.3871,     1.0401,     0.7800,     0.5849,
            0.4386,     0.3289,     0.2467,     0.1850,     0.1387,     0.1040,
            0.0780,     0.0585,     0.0439,     0.0329,     0.0247,     0.0185,
            0.0139,     0.0104,    79.0000,    59.2416,    44.4250,    33.3140,
           24.9820,    18.7339,    14.0484,    10.5348,     7.9000,     5.9242,
            4.4425,     3.3314,     2.4982,     1.8734,     1.4048,     1.0535,
            0.7900,     0.5924,     0.4442,     0.3331,     0.2498,     0.1873,
            0.1405,     0.1053,     0.0790,     0.0592,     0.0444,     0.0333,
            0.0250,     0.0187,     0.0140,     0.0105,    80.0000,    59.9915,
           44.9873,    33.7357,    25.2982,    18.9710,    14.2262,    10.6682,
            8.0000,     5.9992,     4.4987,     3.3736,     2.5298,     1.8971,
            1.4226,     1.0668,     0.8000,     0.5999,     0.4499,     0.3374,
            0.2530,     0.1897,     0.1423,     0.1067,     0.0800,     0.0600,
            0.0450,     0.0337,     0.0253,     0.0190,     0.0142,     0.0107,
           81.0000,    60.7414,    45.5496,    34.1574,    25.6144,    19.2081,
           14.4041,    10.8015,     8.1000,     6.0741,     4.5550,     3.4157,
            2.5614,     1.9208,     1.4404,     1.0802,     0.8100,     0.6074,
            0.4555,     0.3416,     0.2561,     0.1921,     0.1440,     0.1080,
            0.0810,     0.0607,     0.0455,     0.0342,     0.0256,     0.0192,
            0.0144,     0.0108,    82.0000,    61.4913,    46.1120,    34.5791,
           25.9307,    19.4453,    14.5819,    10.9349,     8.2000,     6.1491,
            4.6112,     3.4579,     2.5931,     1.9445,     1.4582,     1.0935,
            0.8200,     0.6149,     0.4611,     0.3458,     0.2593,     0.1945,
            0.1458,     0.1093,     0.0820,     0.0615,     0.0461,     0.0346,
            0.0259,     0.0194,     0.0146,     0.0109,    83.0000,    62.2412,
           46.6743,    35.0008,    26.2469,    19.6824,    14.7597,    11.0682,
            8.3000,     6.2241,     4.6674,     3.5001,     2.6247,     1.9682,
            1.4760,     1.1068,     0.8300,     0.6224,     0.4667,     0.3500,
            0.2625,     0.1968,     0.1476,     0.1107,     0.0830,     0.0622,
            0.0467,     0.0350,     0.0262,     0.0197,     0.0148,     0.0111,
           84.0000,    62.9911,    47.2367,    35.4225,    26.5631,    19.9195,
           14.9375,    11.2016,     8.4000,     6.2991,     4.7237,     3.5423,
            2.6563,     1.9920,     1.4938,     1.1202,     0.8400,     0.6299,
            0.4724,     0.3542,     0.2656,     0.1992,     0.1494,     0.1120,
            0.0840,     0.0630,     0.0472,     0.0354,     0.0266,     0.0199,
            0.0149,     0.0112,    85.0000,    63.7410,    47.7990,    35.8442,
           26.8794,    20.1567,    15.1154,    11.3349,     8.5000,     6.3741,
            4.7799,     3.5844,     2.6879,     2.0157,     1.5115,     1.1335,
            0.8500,     0.6374,     0.4780,     0.3584,     0.2688,     0.2016,
            0.1512,     0.1133,     0.0850,     0.0637,     0.0478,     0.0358,
            0.0269,     0.0202,     0.0151,     0.0113,    86.0000,    64.4909,
           48.3614,    36.2659,    27.1956,    20.3938,    15.2932,    11.4683,
            8.6000,     6.4491,     4.8361,     3.6266,     2.7196,     2.0394,
            1.5293,     1.1468,     0.8600,     0.6449,     0.4836,     0.3627,
            0.2720,     0.2039,     0.1529,     0.1147,     0.0860,     0.0645,
            0.0484,     0.0363,     0.0272,     0.0204,     0.0153,     0.0115,
           87.0000,    65.2408,    48.9237,    36.6876,    27.5118,    20.6310,
           15.4710,    11.6016,     8.7000,     6.5241,     4.8924,     3.6688,
            2.7512,     2.0631,     1.5471,     1.1602,     0.8700,     0.6524,
            0.4892,     0.3669,     0.2751,     0.2063,     0.1547,     0.1160,
            0.0870,     0.0652,     0.0489,     0.0367,     0.0275,     0.0206,
            0.0155,     0.0116,    88.0000,    65.9907,    49.4860,    37.1093,
           27.8280,    20.8681,    15.6489,    11.7350,     8.8000,     6.5991,
            4.9486,     3.7109,     2.7828,     2.0868,     1.5649,     1.1735,
            0.8800,     0.6599,     0.4949,     0.3711,     0.2783,     0.2087,
            0.1565,     0.1173,     0.0880,     0.0660,     0.0495,     0.0371,
            0.0278,     0.0209,     0.0156,     0.0117,    89.0000,    66.7406,
           50.0484,    37.5310,    28.1443,    21.1052,    15.8267,    11.8683,
            8.9000,     6.6741,     5.0048,     3.7531,     2.8144,     2.1105,
            1.5827,     1.1868,     0.8900,     0.6674,     0.5005,     0.3753,
            0.2814,     0.2111,     0.1583,     0.1187,     0.0890,     0.0667,
            0.0500,     0.0375,     0.0281,     0.0211,     0.0158,     0.0119,
           90.0000,    67.4905,    50.6107,    37.9527,    28.4605,    21.3424,
           16.0045,    12.0017,     9.0000,     6.7490,     5.0611,     3.7953,
            2.8461,     2.1342,     1.6005,     1.2002,     0.9000,     0.6749,
            0.5061,     0.3795,     0.2846,     0.2134,     0.1600,     0.1200,
            0.0900,     0.0675,     0.0506,     0.0380,     0.0285,     0.0213,
            0.0160,     0.0120,    91.0000,    68.2404,    51.1731,    38.3744,
           28.7767,    21.5795,    16.1823,    12.1350,     9.1000,     6.8240,
            5.1173,     3.8374,     2.8777,     2.1579,     1.6182,     1.2135,
            0.9100,     0.6824,     0.5117,     0.3837,     0.2878,     0.2158,
            0.1618,     0.1214,     0.0910,     0.0682,     0.0512,     0.0384,
            0.0288,     0.0216,     0.0162,     0.0121,    92.0000,    68.9903,
           51.7354,    38.7961,    29.0930,    21.8166,    16.3602,    12.2684,
            9.2000,     6.8990,     5.1735,     3.8796,     2.9093,     2.1817,
            1.6360,     1.2268,     0.9200,     0.6899,     0.5174,     0.3880,
            0.2909,     0.2182,     0.1636,     0.1227,     0.0920,     0.0690,
            0.0517,     0.0388,     0.0291,     0.0218,     0.0164,     0.0123,
           93.0000,    69.7402,    52.2977,    39.2178,    29.4092,    22.0538,
           16.5380,    12.4017,     9.3000,     6.9740,     5.2298,     3.9218,
            2.9409,     2.2054,     1.6538,     1.2402,     0.9300,     0.6974,
            0.5230,     0.3922,     0.2941,     0.2205,     0.1654,     0.1240,
            0.0930,     0.0697,     0.0523,     0.0392,     0.0294,     0.0221,
            0.0165,     0.0124,    94.0000,    70.4901,    52.8601,    39.6395,
           29.7254,    22.2909,    16.7158,    12.5351,     9.4000,     7.0490,
            5.2860,     3.9639,     2.9725,     2.2291,     1.6716,     1.2535,
            0.9400,     0.7049,     0.5286,     0.3964,     0.2973,     0.2229,
            0.1672,     0.1254,     0.0940,     0.0705,     0.0529,     0.0396,
            0.0297,     0.0223,     0.0167,     0.0125,    95.0000,    71.2400,
           53.4224,    40.0612,    30.0416,    22.5280,    16.8937,    12.6685,
            9.5000,     7.1240,     5.3422,     4.0061,     3.0042,     2.2528,
            1.6894,     1.2668,     0.9500,     0.7124,     0.5342,     0.4006,
            0.3004,     0.2253,     0.1689,     0.1267,     0.0950,     0.0712,
            0.0534,     0.0401,     0.0300,     0.0225,     0.0169,     0.0127,
           96.0000,    71.9898,    53.9848,    40.4829,    30.3579,    22.7652,
           17.0715,    12.8018,     9.6000,     7.1990,     5.3985,     4.0483,
            3.0358,     2.2765,     1.7071,     1.2802,     0.9600,     0.7199,
            0.5398,     0.4048,     0.3036,     0.2277,     0.1707,     0.1280,
            0.0960,     0.0720,     0.0540,     0.0405,     0.0304,     0.0228,
            0.0171,     0.0128,    97.0000,    72.7397,    54.5471,    40.9046,
           30.6741,    23.0023,    17.2493,    12.9352,     9.7000,     7.2740,
            5.4547,     4.0905,     3.0674,     2.3002,     1.7249,     1.2935,
            0.9700,     0.7274,     0.5455,     0.4090,     0.3067,     0.2300,
            0.1725,     0.1294,     0.0970,     0.0727,     0.0545,     0.0409,
            0.0307,     0.0230,     0.0172,     0.0129,    98.0000,    73.4896,
           55.1095,    41.3263,    30.9903,    23.2395,    17.4271,    13.0685,
            9.8000,     7.3490,     5.5109,     4.1326,     3.0990,     2.3239,
            1.7427,     1.3069,     0.9800,     0.7349,     0.5511,     0.4133,
            0.3099,     0.2324,     0.1743,     0.1307,     0.0980,     0.0735,
            0.0551,     0.0413,     0.0310,     0.0232,     0.0174,     0.0131,
           99.0000,    74.2395,    55.6718,    41.7480,    31.3065,    23.4766,
           17.6050,    13.2019,     9.9000,     7.4240,     5.5672,     4.1748,
            3.1307,     2.3477,     1.7605,     1.3202,     0.9900,     0.7424,
            0.5567,     0.4175,     0.3131,     0.2348,     0.1760,     0.1320,
            0.0990,     0.0742,     0.0557,     0.0417,     0.0313,     0.0235,
            0.0176,     0.0132,   100.0000,    74.9894,    56.2341,    42.1697,
           31.6228,    23.7137,    17.7828,    13.3352,    10.0000,     7.4989,
            5.6234,     4.2170,     3.1623,     2.3714,     1.7783,     1.3335,
            1.0000,     0.7499,     0.5623,     0.4217,     0.3162,     0.2371,
            0.1778,     0.1334,     0.1000,     0.0750,     0.0562,     0.0422,
            0.0316,     0.0237,     0.0178,     0.0133,   101.0000,    75.7393,
           56.7965,    42.5913,    31.9390,    23.9509,    17.9606,    13.4686,
           10.1000,     7.5739,     5.6796,     4.2591,     3.1939,     2.3951,
            1.7961,     1.3469,     1.0100,     0.7574,     0.5680,     0.4259,
            0.3194,     0.2395,     0.1796,     0.1347,     0.1010,     0.0757,
            0.0568,     0.0426,     0.0319,     0.0240,     0.0180,     0.0135,
          102.0000,    76.4892,    57.3588,    43.0130,    32.2552,    24.1880,
           18.1385,    13.6019,    10.2000,     7.6489,     5.7359,     4.3013,
            3.2255,     2.4188,     1.8138,     1.3602,     1.0200,     0.7649,
            0.5736,     0.4301,     0.3226,     0.2419,     0.1814,     0.1360,
            0.1020,     0.0765,     0.0574,     0.0430,     0.0323,     0.0242,
            0.0181,     0.0136,   103.0000,    77.2391,    57.9212,    43.4347,
           32.5715,    24.4251,    18.3163,    13.7353,    10.3000,     7.7239,
            5.7921,     4.3435,     3.2571,     2.4425,     1.8316,     1.3735,
            1.0300,     0.7724,     0.5792,     0.4343,     0.3257,     0.2443,
            0.1832,     0.1374,     0.1030,     0.0772,     0.0579,     0.0434,
            0.0326,     0.0244,     0.0183,     0.0137,   104.0000,    77.9890,
           58.4835,    43.8564,    32.8877,    24.6623,    18.4941,    13.8686,
           10.4000,     7.7989,     5.8483,     4.3856,     3.2888,     2.4662,
            1.8494,     1.3869,     1.0400,     0.7799,     0.5848,     0.4386,
            0.3289,     0.2466,     0.1849,     0.1387,     0.1040,     0.0780,
            0.0585,     0.0439,     0.0329,     0.0247,     0.0185,     0.0139,
          105.0000,    78.7389,    59.0458,    44.2781,    33.2039,    24.8994,
           18.6719,    14.0020,    10.5000,     7.8739,     5.9046,     4.4278,
            3.3204,     2.4899,     1.8672,     1.4002,     1.0500,     0.7874,
            0.5905,     0.4428,     0.3320,     0.2490,     0.1867,     0.1400,
            0.1050,     0.0787,     0.0590,     0.0443,     0.0332,     0.0249,
            0.0187,     0.0140,   106.0000,    79.4888,    59.6082,    44.6998,
           33.5201,    25.1366,    18.8498,    14.1353,    10.6000,     7.9489,
            5.9608,     4.4700,     3.3520,     2.5137,     1.8850,     1.4135,
            1.0600,     0.7949,     0.5961,     0.4470,     0.3352,     0.2514,
            0.1885,     0.1414,     0.1060,     0.0795,     0.0596,     0.0447,
            0.0335,     0.0251,     0.0188,     0.0141,   107.0000,    80.2387,
           60.1705,    45.1215,    33.8364,    25.3737,    19.0276,    14.2687,
           10.7000,     8.0239,     6.0171,     4.5122,     3.3836,     2.5374,
            1.9028,     1.4269,     1.0700,     0.8024,     0.6017,     0.4512,
            0.3384,     0.2537,     0.1903,     0.1427,     0.1070,     0.0802,
            0.0602,     0.0451,     0.0338,     0.0254,     0.0190,     0.0143,
          108.0000,    80.9886,    60.7329,    45.5432,    34.1526,    25.6108,
           19.2054,    14.4020,    10.8000,     8.0989,     6.0733,     4.5543,
            3.4153,     2.5611,     1.9205,     1.4402,     1.0800,     0.8099,
            0.6073,     0.4554,     0.3415,     0.2561,     0.1921,     0.1440,
            0.1080,     0.0810,     0.0607,     0.0455,     0.0342,     0.0256,
            0.0192,     0.0144,   109.0000,    81.7385,    61.2952,    45.9649,
           34.4688,    25.8480,    19.3832,    14.5354,    10.9000,     8.1738,
            6.1295,     4.5965,     3.4469,     2.5848,     1.9383,     1.4535,
            1.0900,     0.8174,     0.6130,     0.4596,     0.3447,     0.2585,
            0.1938,     0.1454,     0.1090,     0.0817,     0.0613,     0.0460,
            0.0345,     0.0258,     0.0194,     0.0145,   110.0000,    82.4884,
           61.8575,    46.3866,    34.7851,    26.0851,    19.5611,    14.6687,
           11.0000,     8.2488,     6.1858,     4.6387,     3.4785,     2.6085,
            1.9561,     1.4669,     1.1000,     0.8249,     0.6186,     0.4639,
            0.3479,     0.2609,     0.1956,     0.1467,     0.1100,     0.0825,
            0.0619,     0.0464,     0.0348,     0.0261,     0.0196,     0.0147,
          111.0000,    83.2383,    62.4199,    46.8083,    35.1013,    26.3222,
           19.7389,    14.8021,    11.1000,     8.3238,     6.2420,     4.6808,
            3.5101,     2.6322,     1.9739,     1.4802,     1.1100,     0.8324,
            0.6242,     0.4681,     0.3510,     0.2632,     0.1974,     0.1480,
            0.1110,     0.0832,     0.0624,     0.0468,     0.0351,     0.0263,
            0.0197,     0.0148,   112.0000,    83.9882,    62.9822,    47.2300,
           35.4175,    26.5594,    19.9167,    14.9354,    11.2000,     8.3988,
            6.2982,     4.7230,     3.5418,     2.6559,     1.9917,     1.4935,
            1.1200,     0.8399,     0.6298,     0.4723,     0.3542,     0.2656,
            0.1992,     0.1494,     0.1120,     0.0840,     0.0630,     0.0472,
            0.0354,     0.0266,     0.0199,     0.0149,   113.0000,    84.7380,
           63.5446,    47.6517,    35.7337,    26.7965,    20.0946,    15.0688,
           11.3000,     8.4738,     6.3545,     4.7652,     3.5734,     2.6797,
            2.0095,     1.5069,     1.1300,     0.8474,     0.6354,     0.4765,
            0.3573,     0.2680,     0.2009,     0.1507,     0.1130,     0.0847,
            0.0635,     0.0477,     0.0357,     0.0268,     0.0201,     0.0151,
          114.0000,    85.4879,    64.1069,    48.0734,    36.0500,    27.0337,
           20.2724,    15.2021,    11.4000,     8.5488,     6.4107,     4.8073,
            3.6050,     2.7034,     2.0272,     1.5202,     1.1400,     0.8549,
            0.6411,     0.4807,     0.3605,     0.2703,     0.2027,     0.1520,
            0.1140,     0.0855,     0.0641,     0.0481,     0.0360,     0.0270,
            0.0203,     0.0152,   115.0000,    86.2378,    64.6693,    48.4951,
           36.3662,    27.2708,    20.4502,    15.3355,    11.5000,     8.6238,
            6.4669,     4.8495,     3.6366,     2.7271,     2.0450,     1.5335,
            1.1500,     0.8624,     0.6467,     0.4850,     0.3637,     0.2727,
            0.2045,     0.1534,     0.1150,     0.0862,     0.0647,     0.0485,
            0.0364,     0.0273,     0.0205,     0.0153,   116.0000,    86.9877,
           65.2316,    48.9168,    36.6824,    27.5079,    20.6280,    15.4688,
           11.6000,     8.6988,     6.5232,     4.8917,     3.6682,     2.7508,
            2.0628,     1.5469,     1.1600,     0.8699,     0.6523,     0.4892,
            0.3668,     0.2751,     0.2063,     0.1547,     0.1160,     0.0870,
            0.0652,     0.0489,     0.0367,     0.0275,     0.0206,     0.0155,
          117.0000,    87.7376,    65.7939,    49.3385,    36.9986,    27.7451,
           20.8059,    15.6022,    11.7000,     8.7738,     6.5794,     4.9338,
            3.6999,     2.7745,     2.0806,     1.5602,     1.1700,     0.8774,
            0.6579,     0.4934,     0.3700,     0.2775,     0.2081,     0.1560,
            0.1170,     0.0877,     0.0658,     0.0493,     0.0370,     0.0277,
            0.0208,     0.0156,   118.0000,    88.4875,    66.3563,    49.7602,
           37.3149,    27.9822,    20.9837,    15.7356,    11.8000,     8.8488,
            6.6356,     4.9760,     3.7315,     2.7982,     2.0984,     1.5736,
            1.1800,     0.8849,     0.6636,     0.4976,     0.3731,     0.2798,
            0.2098,     0.1574,     0.1180,     0.0885,     0.0664,     0.0498,
            0.0373,     0.0280,     0.0210,     0.0157,   119.0000,    89.2374,
           66.9186,    50.1819,    37.6311,    28.2193,    21.1615,    15.8689,
           11.9000,     8.9237,     6.6919,     5.0182,     3.7631,     2.8219,
            2.1162,     1.5869,     1.1900,     0.8924,     0.6692,     0.5018,
            0.3763,     0.2822,     0.2116,     0.1587,     0.1190,     0.0892,
            0.0669,     0.0502,     0.0376,     0.0282,     0.0212,     0.0159,
          120.0000,    89.9873,    67.4810,    50.6036,    37.9473,    28.4565,
           21.3394,    16.0023,    12.0000,     8.9987,     6.7481,     5.0604,
            3.7947,     2.8456,     2.1339,     1.6002,     1.2000,     0.8999,
            0.6748,     0.5060,     0.3795,     0.2846,     0.2134,     0.1600,
            0.1200,     0.0900,     0.0675,     0.0506,     0.0379,     0.0285,
            0.0213,     0.0160,   121.0000,    90.7372,    68.0433,    51.0253,
           38.2636,    28.6936,    21.5172,    16.1356,    12.1000,     9.0737,
            6.8043,     5.1025,     3.8264,     2.8694,     2.1517,     1.6136,
            1.2100,     0.9074,     0.6804,     0.5103,     0.3826,     0.2869,
            0.2152,     0.1614,     0.1210,     0.0907,     0.0680,     0.0510,
            0.0383,     0.0287,     0.0215,     0.0161,   122.0000,    91.4871,
           68.6056,    51.4470,    38.5798,    28.9308,    21.6950,    16.2690,
           12.2000,     9.1487,     6.8606,     5.1447,     3.8580,     2.8931,
            2.1695,     1.6269,     1.2200,     0.9149,     0.6861,     0.5145,
            0.3858,     0.2893,     0.2170,     0.1627,     0.1220,     0.0915,
            0.0686,     0.0514,     0.0386,     0.0289,     0.0217,     0.0163,
          123.0000,    92.2370,    69.1680,    51.8687,    38.8960,    29.1679,
           21.8728,    16.4023,    12.3000,     9.2237,     6.9168,     5.1869,
            3.8896,     2.9168,     2.1873,     1.6402,     1.2300,     0.9224,
            0.6917,     0.5187,     0.3890,     0.2917,     0.2187,     0.1640,
            0.1230,     0.0922,     0.0692,     0.0519,     0.0389,     0.0292,
            0.0219,     0.0164,   124.0000,    92.9869,    69.7303,    52.2904,
           39.2122,    29.4050,    22.0507,    16.5357,    12.4000,     9.2987,
            6.9730,     5.2290,     3.9212,     2.9405,     2.2051,     1.6536,
            1.2400,     0.9299,     0.6973,     0.5229,     0.3921,     0.2941,
            0.2205,     0.1654,     0.1240,     0.0930,     0.0697,     0.0523,
            0.0392,     0.0294,     0.0221,     0.0165,   125.0000,    93.7368,
           70.2927,    52.7121,    39.5285,    29.6422,    22.2285,    16.6690,
           12.5000,     9.3737,     7.0293,     5.2712,     3.9528,     2.9642,
            2.2228,     1.6669,     1.2500,     0.9374,     0.7029,     0.5271,
            0.3953,     0.2964,     0.2223,     0.1667,     0.1250,     0.0937,
            0.0703,     0.0527,     0.0395,     0.0296,     0.0222,     0.0167,
          126.0000,    94.4867,    70.8550,    53.1338,    39.8447,    29.8793,
           22.4063,    16.8024,    12.6000,     9.4487,     7.0855,     5.3134,
            3.9845,     2.9879,     2.2406,     1.6802,     1.2600,     0.9449,
            0.7086,     0.5313,     0.3984,     0.2988,     0.2241,     0.1680,
            0.1260,     0.0945,     0.0709,     0.0531,     0.0398,     0.0299,
            0.0224,     0.0168,   127.0000,    95.2366,    71.4174,    53.5555,
           40.1609,    30.1164,    22.5841,    16.9357,    12.7000,     9.5237,
            7.1417,     5.3555,     4.0161,     3.0116,     2.2584,     1.6936,
            1.2700,     0.9524,     0.7142,     0.5356,     0.4016,     0.3012,
            0.2258,     0.1694,     0.1270,     0.0952,     0.0714,     0.0536,
            0.0402,     0.0301,     0.0226,     0.0169};
    EzTensor::ModelArgs args = EzTensor::ModelArgs();
    std::unordered_map<std::string,EzTensor::Tensor> input_weights;
    std::vector<int> shape = {1,2,3,4};
    EzTensor::Tensor dummy(shape);
    input_weights["dummy"] = dummy;
    EzTensor::AttentionLayer attn_layer = EzTensor::AttentionLayer(input_weights, args);
    EzTensor::Tensor freqs = attn_layer.precompute_freq_cis(args.dim / args.n_heads, args.max_seq_len, 10000.0);
    for (int i=0; i<128*32 ;i++){
        float diff = (*freqs.data)[i] - expected_data[i];
        EXPECT_NEAR(diff,0,0.0001);
    }
}


TEST(AttentionTest, TestApplyRotaryEmbedding){
    EzTensor::ModelArgs args = EzTensor::ModelArgs();
    std::vector<int> shape = {1,2,3,4};
    EzTensor::Tensor dummy(shape);
    input_weights["dummy"] = dummy;
    EzTensor::AttentionLayer attn_layer = EzTensor::AttentionLayer(input_weights, args);    
    std::vector<int> xq_shape = {1,args.max_seq_len,args.n_heads * 64};
    std::vector<int> xk_shape = {1,args.max_seq_len,args.n_heads * 64};
    EzTensor::Tensor xq(xq_shape);
    EzTensor::Tensor xk(xk_shape);
    xq.fill_with(5.0);
    xk.fill_with(5.0);
    EzTensor::Tensor freqs = attn_layer.precompute_freq_cis(args.dim / args.n_heads, args.max_seq_len * 2, 10000.0);
    std::unordered_map<std::string,EzTensor::Tensor> rotary_embeddings = attn_layer.apply_rotary_embedding(xq,xk,freqs);
    

}